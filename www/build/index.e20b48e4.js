class t{constructor(t,e){null===t?(this.x=0,this.y=0):(this.x=t,this.y=e)}clone(){return new t(this.x,this.y)}toString(){return`(${this.x}, ${this.y})`}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){let t=this.length();return this.x=this.x/t,this.y=this.y/t,this}norm(){let e=this.length();return new t(this.x/e,this.y/e)}scale(e){return new t(this.x*e,this.y*e)}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,i){return new e(0,0,t.x*i.y-t.y*i.x)}static add(e,i){return new t(e.x+i.x,e.y+i.y)}static sub(e,i){return new t(e.x-i.x,e.y-i.y)}static equal(t,e){return t.x===e.x&&t.y===e.y}}t.Zero=new t(0,0),t.Up=new t(0,1),t.Right=new t(1,0);class e{constructor(t,e,i){null===t?(this.x=0,this.y=0,this.z=0):(this.x=t,this.y=e,this.z=i)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this}norm(){let t=this.length();return new e(this.x/t,this.y/t,this.z/t)}scale(t){return new e(this.x*t,this.y*t,this.z*t)}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,i){return new e(t.y*i.z-t.z*i.y,t.z*i.x-t.x*i.z,t.x*i.y-t.y*i.x)}static add(t,i){return new e(t.x+i.x,t.y+i.y,t.z+i.z)}static sub(t,i){return new e(t.x-i.x,t.y-i.y,t.z-i.z)}static equal(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}}e.Zero=new e(0,0,0),e.Up=new e(0,1,0),e.Down=new e(0,-1,0),e.Left=new e(-1,0,0),e.Right=new e(1,0,0),e.Forward=new e(0,0,-1),e.Backward=new e(0,0,1);let i=1;function n(){let t=`id-${i.toString(16)}`;return i+=1,t}function s(t){let e=`${t.className}-${n()}`;var i=document.createElement("style");return i.type="text/css",i.innerHTML=`${t.className?`.${e}`:""} ${t.id?`#${t.id}`:""} { ${t.content} }`,document.getElementsByTagName("head")[0].appendChild(i),e}class r{constructor(e){let i=e.getBoundingClientRect();this.targetElement=e,this.top=i.top+window.pageYOffset,this.right=i.right+window.pageXOffset,this.bottom=i.bottom+window.pageYOffset,this.left=i.left+window.pageXOffset,this.centerPosition=new t(i.left+window.pageXOffset+(i.right-i.left)/2,i.top+window.pageYOffset+(i.bottom-i.top)/2),this.width=i.right-i.left,this.height=i.top-i.bottom}Recompute(){let t=this.targetElement.getBoundingClientRect();this.top=t.top+window.pageYOffset,this.right=t.right+window.pageXOffset,this.bottom=t.bottom+window.pageYOffset,this.left=t.left+window.pageXOffset,this.centerPosition.x=t.left+window.pageXOffset+(t.right-t.left)/2,this.centerPosition.y=t.top+window.pageYOffset+(t.bottom-t.top)/2,this.width=t.right-t.left,this.height=t.top-t.bottom}Contains(t){return t.x>this.left&&t.x<this.right&&t.y>this.top&&t.y<this.bottom}}class o{}o.EaseInOut={p1x:.32,p1y:0,p2x:.5,p2y:1},o.Linear={p1x:.32,p1y:.32,p2x:.75,p2y:.75},o.DefaultBezierParams={p1x:.5,p1y:.5,p2x:.5,p2y:.5};let a=0,l=0;const d=[];!function t(e){let i=performance.now();l=i-a,a=i;for(let t=d.length-1;t>-1;--t){let e=d[t].AnimationFrame(l);e&&d.splice(t,1)}requestAnimationFrame(t)}(performance.now());class h{constructor(t){this.target=t,this.id=n(),this.startEvent=new CustomEvent("cardAnimationStart"),this.endEvent=new CustomEvent("cardAnimationEnd")}StopAnimation(){let t=d.findIndex(t=>t.id===this.id);t<0||(d.splice(t,1),this.target.dispatchEvent(this.endEvent))}AnimationFrame(t){throw Error("methode not implemented")}}class m extends h{constructor(e,i){super(e),this.rotationFactor=i,this.duration=0,this.p0=t.Zero.clone(),this.p1=t.Zero.clone(),this.travel=t.Zero.clone(),this.elapsedTime=0,this.startTime=-1,this.bezierParams=o.DefaultBezierParams,this.direction=t.Zero.clone(),this.id=n()}StartAnimation(e,i,n,s){this.p0=e.clone(),this.p1=i.clone();let r=t.sub(i,e).length();this.duration=r/n,this.startTime=performance.now()-l,this.elapsedTime=0,this.travel=t.sub(i,e),this.direction=this.travel.norm(),this.bezierParams=s,d.find(t=>t.id===this.id)||d.push(this),this.target.dispatchEvent(this.startEvent)}AnimationFrame(e){if(this.elapsedTime+=e,this.elapsedTime>this.duration||0===this.duration)return this.target.root.style.left=`${this.p1.x}px`,this.target.root.style.top=`${this.p1.y}px`,this.target.currentPosition=this.p1,this.target.LookToward(t.Zero),this.target.dispatchEvent(this.endEvent),!0;let i=this.elapsedTime/this.duration,n=this.rotationFactor,s=function(e,i){let n=e*e,s=n*e,r=3*s-6*n+3*e,o=-3*s+3*n,a=i.p1x*r+i.p2x*o+s,l=i.p1y*r+i.p2y*o+s;return new t(a,l)}(i,this.bezierParams),r=t.add(this.p0,this.travel.scale(s.y));this.target.root.style.left=`${r.x}px`,this.target.root.style.top=`${r.y}px`,this.target.currentPosition=r;// this.target.dispatchEvent(new CustomEvent('animationFrame'));
let o=(function(e,i){let n=e*e,s=9*n-12*e+3,r=-9*n+6*e,o=i.p1x*s+i.p2x*r+3*n,a=i.p1y*s+i.p2y*r+3*n;return new t(o,a)})(i,this.bezierParams).scale(n);return this.target.LookToward(this.direction.scale(o.y)),!1}}class c extends h{constructor(t){super(t),this.duration=0,this.endTime=0,this.startFaceDown=!1,this.elapsedTime=0}StartAnimation(t,e){this.duration=e;let i=performance.now()-l;this.endTime=i+e,this.elapsedTime=0,this.startFaceDown=t,d.find(t=>t.id===this.id)||d.push(this),this.target.dispatchEvent(this.startEvent)}AnimationFrame(t){if(this.elapsedTime+=t,this.target.isFlipped===this.startFaceDown&&this.elapsedTime>=this.duration/2&&this.target.SetFlip(!this.startFaceDown),this.elapsedTime>this.duration||0===this.duration)return this.target.dispatchEvent(this.endEvent),!0;// Animation time from 0 to 1
let e=this.elapsedTime/this.duration;return(// from 0 to .5 to 0 (at .5 the card is side way so invisible, finishing at 0 makes it so the content isn't mirrored)
e=.5-Math.abs(e-.5),this.target.SetRotation(e*Math.PI,0),!1)}}function u(t,e){return i=>{let n=0,s=Number.MAX_VALUE;for(let r=0;r<i.length;++r){i[r].bounds.Recompute();let o=i[r].bounds.centerPosition.x-t,a=i[r].bounds.centerPosition.y-e,l=o*o+a*a;l<s&&(s=l,n=r)}return n}}window.addEventListener("load",()=>{!function(){var i,a;let l=document.getElementById("game-board"),d=document.getElementById("card-root"),h=null;function g(i){let o=`PresentationCard${n()}`;i.classList.add(o);let a={lightDirection:new e(.15,-1,.25).normalize(),simHeight:190,lightPower:1.5,shadowDistance:5},l=function(t,i){t.root=t,t.frontItems=Array.from(t.getElementsByClassName("front")).map(t=>t),t.backItems=Array.from(t.getElementsByClassName("back")).map(t=>t),t.shadeItems=Array.from(t.getElementsByClassName("shade")).map(t=>t),t.shineItems=Array.from(t.getElementsByClassName("shine")).map(t=>t);{let e=Array.from(t.getElementsByClassName("card-item")).map(t=>t);if(1!==e.length)throw'wrong number of element with class "card-item"';t.cardItem=e.pop()}{let e=Array.from(t.getElementsByClassName("zoom-item")).map(t=>t);if(1!==e.length)throw'wrong number of element with class "zoom-item"';t.zoomElement=e.pop()}t.isFlipped=!1;let n={x:i.shadowDistance*e.dot(i.lightDirection,e.Left),y:i.shadowDistance*e.dot(i.lightDirection,e.Down)};t.cardItem.style.filter=`drop-shadow(${n.x}px ${n.y}px 5px black)`;let o=new e(-i.lightDirection.x,-i.lightDirection.y,i.lightDirection.z);t.SetPosition=e=>{t.lerpAnimator.StopAnimation(),t.root.style.left=`${e.x}px`,t.root.style.top=`${e.y}px`,t.currentPosition=e.clone()},t.LookToward=e=>{let n=Math.atan2(Math.abs(e.x),i.simHeight),s=0===e.x?0:e.x>0?n:-n,r=Math.atan2(Math.abs(e.y),i.simHeight),o=0===e.y?0:e.y>0?-r:r;t.SetRotation(s,o)},t.SetRotation=(n,s)=>{// Rotating a vector up toward the viewer to the inclination of the card.
let r=function(t,i,n){let s=Math.cos(i),r=Math.sin(i),o=Math.cos(n),a=Math.sin(n);return new e(t.x*s+t.z*r,t.x*r*a+t.y*o-t.z*a*s,-t.x*r*o+t.y*a+t.z*s*o)}(e.Backward,n,s),a=Math.pow(e.dot(r,i.lightDirection),i.lightPower);t.cardItem.style.transform=`rotateY(${n}rad) rotateX(${s}rad)`;for(let e=0;e<t.shineItems.length;++e)t.shineItems[e].style.opacity=`${100*a}%`;let l=Math.pow(e.dot(r,o),i.lightPower);for(let e=0;e<t.shadeItems.length;++e)t.shadeItems[e].style.opacity=`${100*l}%`};let a=s({className:"zoomin",content:"transition: transform 0.25s ease-out;"});t.zoomElement.classList.add(a),t.SetZoom=e=>{t.zoomElement.style.transform=`scale(${e})`},t.SetSmoothOrientation=e=>{e?t.cardItem.classList.contains(a)||t.cardItem.classList.add(a):t.cardItem.classList.contains(a)&&t.cardItem.classList.remove(a)},t.SetFlip=e=>{for(let i=0;i<t.frontItems.length;++i)t.frontItems[i].style.display=e?"none":"";for(let i=0;i<t.backItems.length;++i)t.backItems[i].style.display=e?"":"none";t.isFlipped=e},t.AnimatedFlip=e=>{t.isFlipped!==e&&t.flipAnimator.StartAnimation(t.isFlipped,750)},t.lerpAnimator=new m(t,100),t.flipAnimator=new c(t);let l=new r(t);return t.currentPosition=l.centerPosition.clone(),t.SetFlip(!1),t}(i,a);return l.LookToward(t.Zero),l}let p=g(d),f=null;function y(t){f=t,h&&h.ContainsCard(t)&&(h.DetachCard(t),h.ReserveSlot(u(t.currentPosition.x,t.currentPosition.y))),t.style.zIndex="100",p.SetSmoothOrientation(!1)}function w(){f&&(f.style.zIndex="99",h&&h.AssignCardToReservation(f),f=null)}function I(t){t.root.addEventListener("mousedown",e=>{y(t)}),t.root.addEventListener("touchstart",t=>{let e=t.target;y(e)},!1),t.root.addEventListener("touchcancel",t=>{w()},!1),t.root.addEventListener("touchend",t=>{w()},!1)}I(p);let x=document.getElementById("slide-button"),v=document.getElementById("slide-test").getElementsByClassName("target"),C=0;function E(e,i,n){let s=new r(e.root),a=s.centerPosition,l=new t(i,n),d=t.sub(l,a).length(),h=(d-45)/135;h<0?h=0:h>1&&(h=1),// Applying a ramp
h*=h;// converting to speed
let m=1.9000000000000001*h+.8;e.lerpAnimator.StartAnimation(a,l,m,o.Linear)}x.addEventListener("click",t=>{C=(C+1)%v.length;let e=new r(v.item(C));z.forEach(t=>{t.ContainsCard(p)&&t.DetachCard(p)}),p.lerpAnimator.StartAnimation(p.currentPosition,e.centerPosition,.65,o.EaseInOut)}),l.addEventListener("mousemove",t=>{f&&E(f,t.clientX,t.clientY)}),l.addEventListener("touchmove",t=>{if(f){let e=t.targetTouches[0];E(f,e.clientX,e.clientY-150)}}),l.addEventListener("mouseup",()=>{w()});let b=[];for(let e=0;e<10;++e){let i=p.cloneNode(!0);l.appendChild(i);let n=g(i);n.lerpAnimator.StartAnimation(n.currentPosition,t.add(n.currentPosition,new t(30*e,0)),.5,o.EaseInOut),I(n),b.push(n)}let A={itemStyle:"width : 5em; height: 5em"},z=[],P=document.getElementsByClassName("card-collection");for(let t=0;t<P.length;++t){let e=P.item(t);z.push(function(t,e){t.itemPool=[],t.itemInUse=[],t.reservingItem=null,t.bounds=new r(t);let i="color:white;";e.itemStyle&&(i+=e.itemStyle);let n=s({className:"CardCollectionItem",content:i});for(let e=0;e<100;++e){let e=document.createElement("div");e.bounds=new r(e),e.classList.add(n),t.itemPool.push(e)}return t.ReserveSlot=e=>{if(t.reservingItem){let i=e(t.itemInUse),n=t.reservingItem.index;if(i!==n){if(i>n)for(let e=n;e<i;++e)t.itemInUse[e].assignedCard=t.itemInUse[e+1].assignedCard;else for(let e=n;e>i;--e)t.itemInUse[e].assignedCard=t.itemInUse[e-1].assignedCard;t.reservingItem=t.itemInUse[i],t.reservingItem.index=i,t.reservingItem.assignedCard=null,t.SlideAllCardsToAssignedItems()}}else{let i=t.itemPool.pop();t.appendChild(i),t.itemInUse.push(i);let n=e(t.itemInUse),s=t.itemInUse.length;for(let e=s-2;e>=n;--e)t.itemInUse[e+1].assignedCard=t.itemInUse[e].assignedCard;t.reservingItem=t.itemInUse[n],t.reservingItem.index=n,t.reservingItem.assignedCard=null,t.bounds.Recompute(),t.SlideAllCardsToAssignedItems()}},t.AssignCardToReservation=e=>{if(!t.reservingItem){console.warn("Trying to assign card but no slot reserved!");return}t.reservingItem.assignedCard=e,t.reservingItem.bounds.Recompute(),e.lerpAnimator.StartAnimation(t.reservingItem.assignedCard.currentPosition,t.reservingItem.bounds.centerPosition,1,o.Linear),e.style.zIndex=t.reservingItem.index.toString(),t.reservingItem=null},t.CancelReservation=()=>{if(!t.reservingItem){console.warn("Cancelling but there is no reservation");return}t.removeChild(t.reservingItem),t.itemInUse.splice(t.reservingItem.index,1),t.reservingItem.assignedCard=null,t.reservingItem.index=-1,t.reservingItem.replaceChildren(),t.itemPool.push(t.reservingItem),t.reservingItem=null,t.SlideAllCardsToAssignedItems()},t.SlideAllCardsToAssignedItems=()=>{t.itemInUse.forEach((t,e)=>{t.assignedCard&&(t.bounds.Recompute(),new r(t.assignedCard),t.assignedCard.lerpAnimator.StartAnimation(t.assignedCard.currentPosition,t.bounds.centerPosition,1,o.EaseInOut),t.assignedCard.style.zIndex=e.toString())})},t.ContainsCard=e=>void 0!==t.itemInUse.find(t=>t.assignedCard===e),t.DetachCard=e=>{let i=t.itemInUse.findIndex(t=>t.assignedCard===e);if(i<0){console.warn("detaching unkown card");return}t.removeChild(t.itemInUse[i]),t.itemInUse.splice(i,1),t.SlideAllCardsToAssignedItems();let n=new CustomEvent("card-detach",{detail:{card:e}});t.dispatchEvent(n)},t.InsertCardInstant=(e,i)=>{let n=t.itemPool.pop();t.itemInUse.splice(i,0,n),t.insertBefore(n,t.childNodes[i+1]),n.assignedCard=e,t.bounds.Recompute(),t.itemInUse.forEach(t=>{t.assignedCard&&(t.bounds.Recompute(),t.assignedCard.SetPosition(t.bounds.centerPosition))})},t.PushCardInstant=e=>{t.InsertCardInstant(e,t.itemInUse.length)},t}(e,A))}l.addEventListener("mousemove",e=>{let i=new t(e.clientX,e.clientY),n=null;for(let t=0;t<z.length;++t){let e=z[t];if(e.bounds.Contains(i)){n=e;break}}n!==h&&(h&&h.reservingItem&&h.CancelReservation(),h=n),n&&f&&n.ReserveSlot(u(e.clientX,e.clientY))});{let t=document.getElementById("mock-collection");b.forEach(e=>{t.PushCardInstant(e)})}{let t=document.getElementById("flip-collection");null===(i=document.getElementById("flip-button"))||void 0===i||i.addEventListener("click",e=>{t.itemInUse.forEach(t=>{t.assignedCard&&t.assignedCard.AnimatedFlip(!t.assignedCard.isFlipped)})})}{let e=document.getElementById("zoom-collection"),i=[];null===(a=document.getElementById("zoom-button"))||void 0===a||a.addEventListener("click",t=>{e.itemInUse.forEach(t=>{t.assignedCard&&(t.assignedCard.SetZoom(2),i.push(t.assignedCard))})}),e.addEventListener("card-detach",t=>{t.detail.card.SetZoom(1),i.splice(i.findIndex(e=>e.id===t.detail.card.id),1)}),l.addEventListener("mousemove",e=>{i&&i.forEach(i=>{let n=t.sub(new t(e.clientX,e.clientY),i.currentPosition).scale(.5);i.LookToward(n)})})}}()});//# sourceMappingURL=index.e20b48e4.js.map

//# sourceMappingURL=index.e20b48e4.js.map
